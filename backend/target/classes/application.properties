# =========================
# App / servidor
# =========================
server.port=8080
spring.application.name=app

# =========================
# Banco de Dados (MySQL REMOTO - DBaaS)
# =========================
spring.datasource.url=jdbc:mysql://passaregua.mysql.dbaas.com.br:3306/passaregua?sslMode=REQUIRED&allowPublicKeyRetrieval=true&serverTimezone=America/Sao_Paulo
spring.datasource.username=passaregua
spring.datasource.password=passaREGUA#1
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# JPA / Hibernate
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect
spring.jpa.properties.hibernate.jdbc.time_zone=America/Sao_Paulo

# =========================
# E-mail (SMTP)
# =========================
spring.mail.host=email-ssl.com.br
spring.mail.port=465
spring.mail.username=passaregua@naysystem.com.br
spring.mail.password=PassaRegua1!
spring.mail.protocol=smtp
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.ssl.enable=true
spring.mail.properties.mail.smtp.starttls.enable=false
spring.mail.properties.mail.smtp.starttls.required=false
spring.mail.default-encoding=UTF-8
spring.mail.properties.mail.smtp.connectiontimeout=5000
spring.mail.properties.mail.smtp.timeout=5000
spring.mail.properties.mail.smtp.writetimeout=5000

# Logs
logging.level.org.springframework=INFO
logging.level.org.springframework.web=INFO
logging.level.org.hibernate.SQL=INFO

# --- HikariCP (pool de conexões) ---
# Mantenha poucas conexões ociosas e renove antes do MySQL derrubar
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.maximum-pool-size=10

# Conexão ociosa por no máx. 5 min
spring.datasource.hikari.idle-timeout=300000

# Vida útil máxima de cada conexão (10–20 min)
# *IMPORTANTE*: sempre menor que o wait_timeout do MySQL (muitos DBaaS usam 600s = 10 min)
spring.datasource.hikari.max-lifetime=600000

# Keepalive a cada 5 min para evitar que o servidor a encerre
spring.datasource.hikari.keepalive-time=300000

# Timeouts de conexão/validação
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.validation-timeout=5000

# Query leve de validação (segura para MySQL)
spring.datasource.hikari.connection-test-query=SELECT 1

# (Opcional) keep-alive em nível de TCP
spring.datasource.url=jdbc:mysql://passaregua.mysql.dbaas.com.br:3306/passaregua?sslMode=REQUIRED&allowPublicKeyRetrieval=true&serverTimezone=America/Sao_Paulo&tcpKeepAlive=true
